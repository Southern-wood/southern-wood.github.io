<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>如何使用 docker 在 Mac 上运行并配置 Ubuntu | Southern</title>
<meta name=keywords content="docker,ubuntu,fish,screenfetch"><meta name=description content="为了完成学校的操作系统设计课程，我需要在 Mac 上运行 Ubuntu 系统。我使用 docker 拉取并运行了一个 Ubuntu 镜像，并在其中配置了 fish shell 和 screenfetch"><meta name=author content="wood"><link rel=canonical href=http://localhost:1313/post/2024/12/run-ubuntu-on-mac-with-docker/pic/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.dbd2bc681cd728315dd5183f09339f07a6e37a6d6f019181d7577f70f1fae335.css integrity="sha256-29K8aBzXKDFd1Rg/CTOfB6bjem1vAZGB11d/cPH64zU=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/post/2024/12/run-ubuntu-on-mac-with-docker/pic/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css integrity=sha384-zh0CIslj+VczCZtlzBcjt5ppRcsAmDnRem7ESsYwWwg3m/OaJ2l4x7YBZl9Kxxib crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js integrity=sha384-Rma6DA2IPUwhNxmrB/7S3Tno0YY7sFu9WSYMCuulLhIqYSGZ2gKCJWIqhBWqMQfh crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js integrity=sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><meta property="og:url" content="http://localhost:1313/post/2024/12/run-ubuntu-on-mac-with-docker/pic/"><meta property="og:site_name" content="Southern"><meta property="og:title" content="如何使用 docker 在 Mac 上运行并配置 Ubuntu"><meta property="og:description" content="为了完成学校的操作系统设计课程，我需要在 Mac 上运行 Ubuntu 系统。我使用 docker 拉取并运行了一个 Ubuntu 镜像，并在其中配置了 fish shell 和 screenfetch"><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-12-21T00:00:00+08:00"><meta property="article:modified_time" content="2024-12-21T00:00:00+08:00"><meta property="article:tag" content="Docker"><meta property="article:tag" content="Ubuntu"><meta property="article:tag" content="Fish"><meta property="article:tag" content="Screenfetch"><meta property="og:image" content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="如何使用 docker 在 Mac 上运行并配置 Ubuntu"><meta name=twitter:description content="为了完成学校的操作系统设计课程，我需要在 Mac 上运行 Ubuntu 系统。我使用 docker 拉取并运行了一个 Ubuntu 镜像，并在其中配置了 fish shell 和 screenfetch"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/post/"},{"@type":"ListItem","position":2,"name":"如何使用 docker 在 Mac 上运行并配置 Ubuntu","item":"http://localhost:1313/post/2024/12/run-ubuntu-on-mac-with-docker/pic/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"如何使用 docker 在 Mac 上运行并配置 Ubuntu","name":"如何使用 docker 在 Mac 上运行并配置 Ubuntu","description":"为了完成学校的操作系统设计课程，我需要在 Mac 上运行 Ubuntu 系统。我使用 docker 拉取并运行了一个 Ubuntu 镜像，并在其中配置了 fish shell 和 screenfetch","keywords":["docker","ubuntu","fish","screenfetch"],"articleBody":"背景 我校的操作系统课程设计是斯坦福大学的 pintos 项目（当然只需要完成少量的 project）。pintos 需要在 x86 架构的 Linux 系统上运行，但是我最近主力使用的是一台 Macbook Pro，我不太愿意每天背着两台电脑去图书馆。\n我原本的设想是把我运行 Ubuntu 机器放在宿舍，通过校园网 ssh 连接到它。但是这样做有两个问题：\n校园网的网络环境不太好，即使是使用代理也无法保证一些软件源的稳定连接。 学校最近在进行消防安全检查，不允许离开宿舍时不断电源，而我没法保证宿舍时刻都有人。 看起来，我只能在 Mac 上跑一个虚拟机了；然而我不太喜欢使用虚拟机的使用体验：在运行时占用太多的内存，启动或者关闭需要等待太长的时间。我希望有一个更轻量的解决方案。\n最近，我关注的 up 主 @TheCW 在沉寂了一年之后忽然更新了一个视频。我重新回看了他之前发布的几个视频后，忽然发现他在 Mac 上需要一个 Linux 环境时，直接用 docker run 了一个全新的 Ubuntu 镜像，这个方法看起来非常轻巧——非常适合我。\n下文是我在 Mac 上使用 docker 运行 Ubuntu 的步骤。\n安装 Docker Desktop for Mac 访问 Docker 官网 下载 Docker Desktop for Mac 即可，这部分不再赘述。\n下载并运行 Ubuntu 镜像 在终端中输入以下命令来拉取 Ubuntu 镜像：\ndocker pull --platform linux/amd64 ubuntu 我使用 –platform 来指定镜像的架构，因为我需要一个 x86 架构的镜像；如果直接使用 docker pull ubuntu，docker 会默认自动选择当前机器的架构，这对我来说当然是不行的。\n拉取完成后，运行以下命令来启动一个新的 Ubuntu 容器：\ndocker run --platform linux/amd64 -it ubuntu /bin/bash 这个命令会启动一个新的 Ubuntu 容器，并且进入 bash shell。不过，这个容器还是一个全新的、仅包含最基本软件的 Ubuntu 系统，它看起来应该是这样的：\nwood@Woods-MacBook-Pro ~\u003e docker exec -it ubuntu bash root@8d907eeb-----:/# 如果需要退出容器，使用 exit 命令。\n如果要重新进入容器，可以使用 docker ps -a 查看容器的 ID，然后使用 docker start 和 docker attach 命令。\n我们首先应该要新建一个用户，因为 root 用户不应该用于日常操作。在容器中依次以下命令：\napt update apt install sudo adduser adduser 如果你在 apt update 时遇到了网络问题，可以尝试更换软件源，或者使用代理（参看代理 Docker 容器）。\n在按照提示设置密码和其他信息后，我们需要将新建的用户加入 sudo 组：\nusermod -aG sudo 使用 su 命令切换到新建的用户，并测试一下 sudo 是否正常工作：\nsu - sudo whoami 如果输出为 root，则说明 sudo 已经正常工作。\nDocker 快捷命令 在继续配置 Ubuntu 容器之前，我想先让启动和退出容器更加方便。\n首先使用 docker ps -a 查看容器的 ID，然后使用 docker rename ubuntu 命令为容器设置别名为 ubuntu。\n随后，我在 ~/.config/fish/config.fish 中添加了以下两个 alias：\nalias ubuntu 'docker start ubuntu \u0026\u0026 docker attach ubuntu' alias ubuntu-stop 'docker stop ubuntu' 运行 source ~/.config/fish/config.fish 使配置生效。\nps: 如果你使用的是 bash，可以将 alias 添加到 ~/.bashrc 中，并运行 source ~/.bashrc，注意，bash 的 alias 语法和 fish 有所不同，需要使用一个 = 号：alias ubuntu='docker start ubuntu \u0026\u0026 docker attach ubuntu'。\n配置 Ubuntu 容器 fish shell 我习惯使用 fish shell，并以 fish 为默认 shell。在容器中，我首先安装了 fish shell：\nsudo apt install fish 我没有使用 chsh 命令来更改默认 shell，而是直接修改了对 ubuntu 命令的 alias：\nalias ubuntu \"docker start ubuntu \u0026\u0026 \\ docker exec -it --user \\ ubuntu fish -C 'cd ~'\" 这样，每次进入容器时，都会以普通用户的身份进入 fish shell，并且进入到用户目录。\n到这里，我已经接近了日常使用 Ubuntu 的体验。\nscreenfetch 我喜欢登陆时看到 screenfetch，诚实地说，是因为这满足了我小时候对“黑客”的幻想。\n我需要在 Docker 容器中安装 screenfetch，然后在 fish 的配置文件中添加 screenfetch 命令。\nsudo apt install screenfetch echo \"screenfetch 2\u003e/dev/null\" \u003e\u003e ~/.config/fish/config.fish 这里，因为 screenfetch 无法访问宿主机的信息，会显示一行错误信息，所以我在 screenfetch 命令后面加了一个 2\u003e/dev/null 来丢弃错误信息。\n我说，谁能拒绝一个 screenfetch 呢？\n配置 Docker 容器代理 注意，这不是代理 Docker 的软件源，而是代理 Docker 容器内的网络。\n编辑 ~/.docker/config.json 文件，添加以下内容：\n{ \"proxies\": { \"default\": { \"httpProxy\": \"http://proxy.example.com:8080\", \"httpsProxy\": \"http://proxy.example.com:8080\" } } } 这里的 httpProxy 和 httpsProxy 需要根据你实际的代理设置进行修改。\n","wordCount":"1477","inLanguage":"en","image":"http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-12-21T00:00:00+08:00","dateModified":"2024-12-21T00:00:00+08:00","author":{"@type":"Person","name":"wood"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/post/2024/12/run-ubuntu-on-mac-with-docker/pic/"},"publisher":{"@type":"Organization","name":"Southern","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/categories/ title=categories><span>categories</span></a></li><li><a href=http://localhost:1313/tags/ title=tags><span>tags</span></a></li><li><a href=http://localhost:1313/about/ title=about><span>about</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/post/>Posts</a></div><h1 class="post-title entry-hint-parent">如何使用 docker 在 Mac 上运行并配置 Ubuntu</h1><div class=post-meta><span title='2024-12-21 00:00:00 +0800 CST'>December 21, 2024</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;1477 words</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e8%83%8c%e6%99%af aria-label=背景>背景</a></li><li><a href=#%e5%ae%89%e8%a3%85-docker-desktop-for-mac aria-label="安装 Docker Desktop for Mac">安装 Docker Desktop for Mac</a></li><li><a href=#%e4%b8%8b%e8%bd%bd%e5%b9%b6%e8%bf%90%e8%a1%8c-ubuntu-%e9%95%9c%e5%83%8f aria-label="下载并运行 Ubuntu 镜像">下载并运行 Ubuntu 镜像</a></li><li><a href=#docker-%e5%bf%ab%e6%8d%b7%e5%91%bd%e4%bb%a4 aria-label="Docker 快捷命令">Docker 快捷命令</a></li><li><a href=#%e9%85%8d%e7%bd%ae-ubuntu-%e5%ae%b9%e5%99%a8 aria-label="配置 Ubuntu 容器">配置 Ubuntu 容器</a><ul><li><a href=#fish-shell aria-label="fish shell">fish shell</a></li><li><a href=#screenfetch aria-label=screenfetch>screenfetch</a></li></ul></li><li><a href=#%e9%85%8d%e7%bd%ae-docker-%e5%ae%b9%e5%99%a8%e4%bb%a3%e7%90%86 aria-label="配置 Docker 容器代理">配置 Docker 容器代理</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=背景>背景<a hidden class=anchor aria-hidden=true href=#背景>#</a></h2><p>我校的操作系统课程设计是斯坦福大学的 pintos 项目（当然只需要完成少量的 project）。pintos 需要在 x86 架构的 Linux 系统上运行，但是我最近主力使用的是一台 Macbook Pro，我不太愿意每天背着两台电脑去图书馆。</p><p>我原本的设想是把我运行 Ubuntu 机器放在宿舍，通过校园网 ssh 连接到它。但是这样做有两个问题：</p><ol><li>校园网的网络环境不太好，即使是使用代理也无法保证一些软件源的稳定连接。</li><li>学校最近在进行消防安全检查，不允许离开宿舍时不断电源，而我没法保证宿舍时刻都有人。</li></ol><p>看起来，我只能在 Mac 上跑一个虚拟机了；然而我不太喜欢使用虚拟机的使用体验：在运行时占用太多的内存，启动或者关闭需要等待太长的时间。我希望有一个更轻量的解决方案。</p><p>最近，我关注的 up 主 <a href=https://space.bilibili.com/13081489>@TheCW</a> 在沉寂了一年之后忽然更新了一个视频。我重新回看了他之前发布的几个视频后，忽然发现他在 Mac 上需要一个 Linux 环境时，直接用 docker run 了一个全新的 Ubuntu 镜像，这个方法看起来非常轻巧——非常适合我。</p><p>下文是我在 Mac 上使用 docker 运行 Ubuntu 的步骤。</p><h2 id=安装-docker-desktop-for-mac>安装 Docker Desktop for Mac<a hidden class=anchor aria-hidden=true href=#安装-docker-desktop-for-mac>#</a></h2><p>访问 <a href=https://www.docker.com/products/docker-desktop>Docker 官网</a> 下载 Docker Desktop for Mac 即可，这部分不再赘述。</p><h2 id=下载并运行-ubuntu-镜像>下载并运行 Ubuntu 镜像<a hidden class=anchor aria-hidden=true href=#下载并运行-ubuntu-镜像>#</a></h2><p>在终端中输入以下命令来拉取 Ubuntu 镜像：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker pull --platform linux/amd64 ubuntu
</span></span></code></pre></div><p>我使用 &ndash;platform 来指定镜像的架构，因为我需要一个 x86 架构的镜像；如果直接使用 <code>docker pull ubuntu</code>，docker 会默认自动选择当前机器的架构，这对我来说当然是不行的。</p><p>拉取完成后，运行以下命令来启动一个新的 Ubuntu 容器：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run --platform linux/amd64 -it ubuntu /bin/bash
</span></span></code></pre></div><p>这个命令会启动一个新的 Ubuntu 容器，并且进入 bash shell。不过，这个容器还是一个全新的、仅包含最基本软件的 Ubuntu 系统，它看起来应该是这样的：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wood@Woods-MacBook-Pro ~&gt; docker <span class=nb>exec</span> -it ubuntu bash
</span></span><span class=line><span class=cl>root@8d907eeb-----:/# 
</span></span></code></pre></div><p>如果需要退出容器，使用 <code>exit</code> 命令。</p><p>如果要重新进入容器，可以使用 <code>docker ps -a</code> 查看容器的 ID，然后使用 <code>docker start &lt;container-id></code> 和 <code>docker attach &lt;container-id></code> 命令。</p><p>我们首先应该要新建一个用户，因为 root 用户不应该用于日常操作。在容器中依次以下命令：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>apt update
</span></span><span class=line><span class=cl>apt install sudo adduser
</span></span><span class=line><span class=cl>adduser &lt;your-username&gt;
</span></span></code></pre></div><p>如果你在 apt update 时遇到了网络问题，可以尝试更换软件源，或者使用代理（参看<a href=#%E9%85%8D%E7%BD%AE-docker-%E5%AE%B9%E5%99%A8%E4%BB%A3%E7%90%86>代理 Docker 容器</a>）。</p><p>在按照提示设置密码和其他信息后，我们需要将新建的用户加入 sudo 组：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>usermod -aG sudo &lt;your-username&gt;
</span></span></code></pre></div><p>使用 su 命令切换到新建的用户，并测试一下 sudo 是否正常工作：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>su - &lt;your-username&gt;
</span></span><span class=line><span class=cl>sudo whoami
</span></span></code></pre></div><p>如果输出为 <code>root</code>，则说明 sudo 已经正常工作。</p><h2 id=docker-快捷命令>Docker 快捷命令<a hidden class=anchor aria-hidden=true href=#docker-快捷命令>#</a></h2><p>在继续配置 Ubuntu 容器之前，我想先让启动和退出容器更加方便。</p><p>首先使用 <code>docker ps -a</code> 查看容器的 ID，然后使用 <code>docker rename &lt;container-id> ubuntu</code> 命令为容器设置别名为 ubuntu。</p><p>随后，我在 <code>~/.config/fish/config.fish</code> 中添加了以下两个 alias：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fish data-lang=fish><span class=line><span class=cl><span class=nb>alias </span>ubuntu <span class=s1>&#39;docker start ubuntu &amp;&amp; docker attach ubuntu&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>alias </span>ubuntu-stop <span class=s1>&#39;docker stop ubuntu&#39;</span>
</span></span></code></pre></div><p>运行 <code>source ~/.config/fish/config.fish</code> 使配置生效。</p><p>ps: 如果你使用的是 bash，可以将 alias 添加到 <code>~/.bashrc</code> 中，并运行 <code>source ~/.bashrc</code>，注意，bash 的 alias 语法和 fish 有所不同，需要使用一个 <code>=</code> 号：<code>alias ubuntu='docker start ubuntu && docker attach ubuntu'</code>。</p><h2 id=配置-ubuntu-容器>配置 Ubuntu 容器<a hidden class=anchor aria-hidden=true href=#配置-ubuntu-容器>#</a></h2><h3 id=fish-shell>fish shell<a hidden class=anchor aria-hidden=true href=#fish-shell>#</a></h3><p>我习惯使用 fish shell，并以 fish 为默认 shell。在容器中，我首先安装了 fish shell：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install fish
</span></span></code></pre></div><p>我没有使用 <code>chsh</code> 命令来更改默认 shell，而是直接修改了对 <code>ubuntu</code> 命令的 alias：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>alias</span> ubuntu <span class=s2>&#34;docker start ubuntu &amp;&amp; \
</span></span></span><span class=line><span class=cl><span class=s2>docker exec -it --user &lt;your-username&gt; \
</span></span></span><span class=line><span class=cl><span class=s2>ubuntu fish -C &#39;cd ~&#39;&#34;</span>
</span></span></code></pre></div><p>这样，每次进入容器时，都会以普通用户的身份进入 fish shell，并且进入到用户目录。</p><p>到这里，我已经接近了日常使用 Ubuntu 的体验。</p><h3 id=screenfetch>screenfetch<a hidden class=anchor aria-hidden=true href=#screenfetch>#</a></h3><p>我喜欢登陆时看到 screenfetch，诚实地说，是因为这满足了我小时候对“黑客”的幻想。</p><p>我需要在 Docker 容器中安装 screenfetch，然后在 fish 的配置文件中添加 screenfetch 命令。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install screenfetch
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;screenfetch 2&gt;/dev/null&#34;</span> &gt;&gt; ~/.config/fish/config.fish
</span></span></code></pre></div><p>这里，因为 screenfetch 无法访问宿主机的信息，会显示一行错误信息，所以我在 screenfetch 命令后面加了一个 <code>2>/dev/null</code> 来丢弃错误信息。</p><p>我说，谁能拒绝一个 screenfetch 呢？</p><p><img alt=screenfetch loading=lazy src=/post/2024/12/run-ubuntu-on-mac-with-docker/pic/pic/screen.png></p><h2 id=配置-docker-容器代理>配置 Docker 容器代理<a hidden class=anchor aria-hidden=true href=#配置-docker-容器代理>#</a></h2><p>注意，这不是代理 Docker 的软件源，而是代理 Docker 容器内的网络。</p><p>编辑 <code>~/.docker/config.json</code> 文件，添加以下内容：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;proxies&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;default&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>     <span class=nt>&#34;httpProxy&#34;</span><span class=p>:</span> <span class=s2>&#34;http://proxy.example.com:8080&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>     <span class=nt>&#34;httpsProxy&#34;</span><span class=p>:</span> <span class=s2>&#34;http://proxy.example.com:8080&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>这里的 <code>httpProxy</code> 和 <code>httpsProxy</code> 需要根据你实际的代理设置进行修改。</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/docker/>Docker</a></li><li><a href=http://localhost:1313/tags/ubuntu/>Ubuntu</a></li><li><a href=http://localhost:1313/tags/fish/>Fish</a></li><li><a href=http://localhost:1313/tags/screenfetch/>Screenfetch</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/post/2024/12/benchmarks-in-time-series-anormaly-detection/><span class=title>« Prev</span><br><span>Benchmarks in Time Series Anormaly Detection</span>
</a><a class=next href=http://localhost:1313/post/2024/12/changes-to-cs-from-ai/><span class=title>Next »</span><br><span>AI 时代，知识的价值</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>Southern</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>